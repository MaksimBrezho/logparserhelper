# ✨ Окно редактора преобразований

Диалог Transform Editor используется при задании правил сопоставления в генераторе кода CEF. Он позволяет настроить форматирование, замену или перестановку извлечённых значений перед присвоением конкретному полю CEF.

## Обзор интерфейса

Окно создаётся классом `TransformEditorDialog` из `gui/transform_editor.py` и содержит следующие элементы:

1. **Отображение regex** – показывает регулярное выражение, связанное с текущим сопоставлением, если оно было передано при открытии.
2. **Список примеров** – отображает образцы значений для поля. Каждое значение показано до и после преобразования.
3. **Параметры форматирования** – набор переключателей для базовых преобразований строк:
   - `none` – оставить текст как есть
   - `lower` – перевести в нижний регистр
   - `upper` – перевести в верхний регистр
   - `capitalize` – каждое слово с заглавной буквы
   - `sentence` – только первое слово с заглавной буквы
4. **Соответствия значений (ключ=значение на строку)** – многострочное поле, в котором каждая строка содержит `ключ=значение`. Подходящие входные значения заменяются соответствующим выходным.
5. **Заменить при совпадении** – два поля для указания регулярного выражения и текста замены. Если выражение совпадает, значение меняется.
6. **Настройки токенов** – при наличии regex можно включить управление порядком токенов или их удалением. Токены определяются по лучшему совпадению и могут перетаскиваться мышью или удаляться клавишей <kbd>Delete</kbd>.
7. **Область предпросмотра** – показывает примеры с применённым преобразованием. Используйте **Применить** (`Ctrl+Enter`), чтобы обновить.
8. **Меню File** – команды **Сохранить** (`Ctrl+S`) и **Отмена** (`Esc`).

## Возвращаемые данные

При сохранении диалог выдаёт описание преобразования. В простых случаях это строка с одним из режимов форматирования. Если заполнены другие поля, возвращается словарь со следующими ключами:

- `format` – один из базовых режимов форматирования
- `value_map` – отображение входных значений на замены (опционально)
- `replace_pattern` / `replace_with` – подстановка по регулярному выражению (опционально)
- `token_order` и `regex` – список, описывающий порядок токенов (опционально)

Это описание затем используется функцией `utils.transform_logic.apply_transform` для преобразования значений в ходе обработки логов.
